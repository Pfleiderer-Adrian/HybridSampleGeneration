from pathlib import Path
from typing import Iterable, List


def matching_filenames_without_extension(folder_path: str, allowed_names: Iterable[str]) -> List[str]:
    folder = Path(folder_path)

    if not folder.exists():
        raise FileNotFoundError(f"Ordner existiert nicht: {folder_path}")
    if not folder.is_dir():
        raise NotADirectoryError(f"Pfad ist kein Ordner: {folder_path}")

    allowed_set = set(allowed_names)

    matches = [p.stem for p in folder.iterdir() if p.is_file() and p.stem in allowed_set]
    matches.sort()  # optional: stabile Reihenfolge
    print(len(matches))
    print("[" + ",".join(f'"{name}"' for name in matches[:29]) + "]")
    return matches


def main() -> None:
    # Beispiel: passe den Pfad und die Liste an
    folder_path = "/mnt/results/results/nnUNet/nnUNet_raw/Dataset007_BerlinFusionMatchedAnomalies180-137SameFold/labelsTr"
    allowed_names = ["synth-230307995-035047-S-C-070.0-20230324180246",
            "synth-230324958-036367-S-A-240.0-20230504080416",
            "synth-230324958-036367-S-C-260.0-20230504080326",
            "synth-230324958-036368-S-C-140.0-20230504080900",
            "synth-230324958-036368-S-C-170.0-20230504080904",
            "synth-230324958-036368-S-C-350.0-20230504080924",
            "synth-230324980-036147-S-A-100.0-20230427174301",
            "synth-230324980-036147-S-A-290.0-20230427174323",
            "synth-230329980-036537-S-A-250.0-20230427154544",
            "synth-230329980-036537-S-C-090.0-20230427154433",
            "synth-230405958-036987-S-C-140.0-20230504092441",
            "synth-230428971-037950-S-C-080.0-20230613174557",
            "synth-230504959-038333-S-A-280.0-20230717185932",
            "synth-230531978-039611-S-C-100.0-20230713101025",
            "synth-230531978-039611-S-C-110.0-20230713101026",
            "synth-230531978-039611-S-C-290.0-20230713101046",
            "synth-230531978-039615-S-C-150.0-20230713111403",
            "synth-230531981-039584-S-C-200.0-20230714084303",
            "synth-230531981-039584-S-C-230.0-20230714084306",
            "synth-230531995-039442-S-A-090.0-20230711123246",
            "synth-230531995-039442-S-A-100.0-20230711123247",
            "synth-230531995-039442-S-A-250.0-20230711123304",
            "synth-230531995-039442-S-C-070.0-20230711123151",
            "synth-230531998-039419-S-C-090.0-20230725071854",
            "synth-230605947-039746-S-A-260.0-20230725175501",
            "synth-230607972-040019-S-A-310.0-20230726113814",
            "synth-230607981-039922-S-C-020.0-20230717201135",
            "synth-230607981-039922-S-C-040.0-20230717201138",
            "synth-230607983-039907-S-A-070.0-20230725103357",
            "synth-230607983-039907-S-A-260.0-20230725103418",
            "synth-230607994-039793-S-A-250.0-20230727064507",
            "synth-230607995-039781-S-A-160.0-20230705061349",
            "synth-230607995-039781-S-A-330.0-20230705061408",
            "synth-230612955-040096-S-A-050.0-20230725083103",
            "synth-230612956-040084-S-A-090.0-20230721154758",
            "synth-230612956-040084-S-A-290.0-20230721154820",
            "synth-230612956-040084-S-C-270.0-20230721154725",
            "synth-230612956-040084-S-C-280.0-20230721154727",
            "synth-230612956-040086-S-C-020.0-20230721155847",
            "synth-230612956-040086-S-C-030.0-20230721155848",
            "synth-230612961-040033-S-A-110.0-20230714115943",
            "synth-230612961-040033-S-A-310.0-20230714120005",
            "synth-230614961-040332-S-A-110.0-20230725110416",
            "synth-230614961-040332-S-C-250.0-20230725110339",
            "synth-230614962-040327-S-A-140.0-20230724150128",
            "synth-230614962-040327-S-C-280.0-20230724150050",
            "synth-230614968-040262-S-C-100.0-20230714080217",
            "synth-230614968-040262-S-C-110.0-20230714080218",
            "synth-230614975-040193-S-C-130.0-20230726095430",
            "synth-230614975-040197-S-A-060.0-20230717195506",
            "synth-230614975-040197-S-A-220.0-20230717195524",
            "synth-230614975-040197-S-A-240.0-20230717195526",
            "synth-230614975-040197-S-C-060.0-20230717195413",
            "synth-230614975-040197-S-C-260.0-20230717195436",
            "synth-230623955-041006-S-C-090.0-20230720142751",
            "synth-230623955-041006-S-C-290.0-20230720142813",
            "synth-230628984-041284-S-A-120.0-20230823172015",
            "synth-230628984-041284-S-A-150.0-20230823172019",
            "synth-230628984-041284-S-A-280.0-20230823172033",
            "synth-230628984-041287-S-A-270.0-20230823162421",
            "synth-230628984-041287-S-C-060.0-20230823162305",
            "synth-230628984-041287-S-C-240.0-20230823162325",
            "synth-230705979-041912-S-A-250.0-20230828091852",
            "synth-230705979-041912-S-A-270.0-20230828091854",
            "synth-230705991-041797-S-A-130.0-20230829105217",
            "synth-230705991-041797-S-C-050.0-20230829105115",
            "synth-230707994-042057-S-C-060.0-20230829095107",
            "synth-230707994-042058-S-C-110.0-20230829095651",
            "synth-230707994-042058-S-C-150.0-20230829095655",
            "synth-230707994-042058-S-C-310.0-20230829095713",
            "synth-230718976-042683-S-A-140.0-20230920200228",
            "synth-230718976-042683-S-A-310.0-20230920200247",
            "synth-230731988-042941-S-A-280.0-20231005180040",
            "synth-230731988-042941-S-C-120.0-20231005175929",
            "synth-230731988-042941-S-C-270.0-20231005175946",
            "synth-230818986-043280-S-C-080.0-20231011103730",
            "synth-230818986-043280-S-C-090.0-20231011103731",
            "synth-230818986-043280-S-C-230.0-20231011103747",
            "synth-230818990-043249-S-C-180.0-20231031192631",
            "synth-230914976-044305-S-A-080.0-20231122064122",
            "synth-230914976-044305-S-A-270.0-20231122064144",
            "synth-230914976-044305-S-C-120.0-20231122064033",
            "synth-230919991-044376-S-A-160.0-20231020094053",
            "synth-230919991-044376-S-A-240.0-20231020094102",
            "synth-230919991-044376-S-A-250.0-20231020094103",
            "synth-230919991-044376-S-A-300.0-20231020094109",
            "synth-230928952-044765-S-A-080.0-20231113071321",
            "synth-230928952-044765-S-A-250.0-20231113071341",
            "synth-230928952-044765-S-C-100.0-20231113071230",
            "synth-230928952-044765-S-C-310.0-20231113071254",
            "synth-231009935-045212-S-A-340.0-20231107120513",
            "synth-231009935-045212-S-C-310.0-20231107120416",
            "synth-231012992-045310-S-A-080.0-20231107094833",
            "synth-231012992-045310-S-C-090.0-20231107094741",
            "synth-231012992-045310-S-C-140.0-20231107094747",
            "synth-231012992-045310-S-C-310.0-20231107094806",
            "synth-231012992-045310-S-C-320.0-20231107094808",
            "synth-231012998-045259-S-A-070.0-20231117112128",
            "synth-231013977-045411-S-C-000.0-20231116105144",
            "synth-231013977-045411-S-C-220.0-20231116105209",
            "synth-231013977-045411-S-C-230.0-20231116105210",
            "synth-231013982-045361-S-A-260.0-20231122082906",
            "synth-231013982-045361-S-C-270.0-20231122082813",
            "synth-231027991-046114-S-A-080.0-20231214154007",
            "synth-231027991-046114-S-A-100.0-20231214154009",
            "synth-231027991-046114-S-A-280.0-20231214154030",
            "synth-231027991-046114-S-A-310.0-20231214154033",
            "synth-231220955-048963-S-A-070.0-20240130092551",
            "synth-231220955-048963-S-A-250.0-20240130092612",
            "synth-231220965-048860-S-A-070.0-20240129093225",
            "synth-231220965-048860-S-A-250.0-20240129093245",
            "synth-231220965-048860-S-A-260.0-20240129093246",
            "synth-240111969-049235-S-A-230.0-20240208171910",
            "synth-240112958-049780-S-C-080.0-20240319153408",
            "synth-240112958-049780-S-C-100.0-20240319153410",
            "synth-240118973-050406-S-C-080.0-20240213181134",
            "synth-240126885-053978-S-A-240.0-20240213075541",
            "synth-230324958-036367-S-C-090.0-20230504080307",
            "synth-230324958-036368-S-C-330.0-20230504080922",
            "synth-230329980-036537-S-A-220.0-20230427154541",
            "synth-230531978-039615-S-A-100.0-20230713111450",
            "synth-230531991-039480-S-C-080.0-20230712174515",
            "synth-230607972-040019-S-C-080.0-20230726113655",
            "synth-230607981-039922-S-C-110.0-20230717201146",
            "synth-230607983-039903-S-A-280.0-20230724195335",
            "synth-230612956-040086-S-C-000.0-20230721155845",
            "synth-230612956-040086-S-C-200.0-20230721155907",
            "synth-230612961-040033-S-A-130.0-20230714115945",
            "synth-230623955-041006-S-A-070.0-20230720142841",
            "synth-230623955-041006-S-C-270.0-20230720142811",
            "synth-230705987-041834-S-A-340.0-20230828175628",
            "synth-230705991-041797-S-A-270.0-20230829105233",
            "synth-230707994-042057-S-C-290.0-20230829095132",
            "synth-230818986-043280-S-A-280.0-20231011103845",
            "synth-230818990-043249-S-C-010.0-20231031192611",
            "synth-230818990-043249-S-C-200.0-20231031192633",
            "synth-230914976-044305-S-A-100.0-20231122064124",
            "synth-230914976-044305-S-C-320.0-20231122064056",
            "synth-230919991-044376-S-C-280.0-20231020094013",
            "synth-231012992-045310-S-C-160.0-20231107094749",
            "synth-231013982-045361-S-C-070.0-20231122082751",
            "synth-231127984-047358-S-C-310.0-20240102192151",
            "synth-231220955-048963-S-A-270.0-20240130092614",
            "synth-240111969-049235-S-A-070.0-20240208171852"]

    matching_filenames_without_extension(folder_path, allowed_names)


if __name__ == "__main__":
    main()
